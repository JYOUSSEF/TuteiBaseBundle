{% set language = siteaccess[ezpublish.siteaccess.name].language %}

{% if content.versionInfo.names[language] is defined %}
    {% set name = content.versionInfo.names[language] %}
{% else %}
    {% set name = location.contentInfo.name %}
{% endif %}


{% set newWindow = content.fields.new_window[language].bool %}

{% set link = '' %}

{% if content.fields.link_object[language] is defined %}
    {% set link = path(relationList[content.fields.link_object[language].destinationContentId]) %}
{% elseif not ez_is_field_empty( content, "link_external" ) %}
    {% set link = content.fields.link_external[language].link %}
{% endif %}

<div class="panel panel-default">
    
  <div class="panel-heading">
      <h3 class="panel-title">
          <a href="{{ link }}"{% if newWindow %} target="_blank"{% endif %}>{{ name }}</a>
      </h3>
  </div>

  {% if not ez_is_field_empty( content, "image" ) %}
  <div class="attribute-image">
      <a href="{{ link }}"{% if newWindow %} target="_blank"{% endif %}>
        {{ ez_render_field(content, 'image', {
                                        parameters:{ alias:'small' },
                                        attr:{ class:'block_item', custom_attribute:'value' }
                                     }
                  )
        }}
      </a>
  </div>
  {% endif %}
    
  <div class="panel-body">
    {% if content.fields.body is defined %}
            {{ ez_render_field( content, 'body', { lang: language } ) }}    
    {% endif %}
  </div>
</div>